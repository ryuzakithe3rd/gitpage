import{R as V,S as j,P as _,a as q,D as L,W as $,b as K,G as X,O as Y,c as U,d as J,U as Q,e as Z,f as ee,C as I,M,g as te,h as ne,H as oe,V as b,i as re,j as A,N as B,k as ae,l as ie,m as se,n as le,o as H}from"./vendor.f37ee329.js";const ue=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const t of o)if(t.type==="childList")for(const a of t.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function n(o){const t={};return o.integrity&&(t.integrity=o.integrity),o.referrerpolicy&&(t.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?t.credentials="include":o.crossorigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function i(o){if(o.ep)return;o.ep=!0;const t=n(o);fetch(o.href,t)}};ue();const d=128,c=512,m=c*.5;let g,D,f,h,u,T=!1;const N=new b,O=new V;let p,w,l,s,G,v,P,R;const E=new H,S=5,F=[];let z=!0;const de=new j;ce();k();function ce(){g=document.createElement("div",{class:"omnomnomonomnom"}),document.body.appendChild(g),f=new _(75,window.innerWidth/window.innerHeight,1,3e3),f.position.set(0,1e3,0),f.lookAt(0,0,0),h=new q;const r=new L(16777215,.1);r.position.set(0,1,0),h.add(r);const e=new L(4235328,.6);h.add(e),u=new $,u.setPixelRatio(window.devicePixelRatio),u.setSize(window.innerWidth,window.innerHeight),g.appendChild(u.domElement),D=new K,g.appendChild(D.dom),g.style.touchAction="none",g.addEventListener("pointermove",ye),document.addEventListener("keydown",function(t){t.keyCode===87&&(p.material.wireframe=!p.material.wireframe,p.material.needsUpdate=!0)}),window.addEventListener("resize",we);const n=new X,i={mouseSize:11,viscosity:.94,spheresEnabled:!1},o=function(){s.material.uniforms.mouseSize.value=i.mouseSize,s.material.uniforms.viscosityConstant.value=i.viscosity,z=i.spheresEnabled;for(let t=0;t<S;t++)F[t]&&(F[t].visible=z)};n.add(i,"mouseSize",1,100,1).onChange(o),n.add(i,"viscosity",.9,.999,.001).onChange(o),me(),he(),o(),new Y(f,u.domElement)}function me(){const r=new U(c,c,d-1,d-1),e=new J({uniforms:Q.merge([Z.phong.uniforms,{heightmap:{value:null}}]),vertexShader:document.getElementById("waterVertexShader").textContent,fragmentShader:ee.meshphong_frag});e.lights=!0,Se("#DAFBFF");const n=0,i=16576;console.log(e.opacity),e.color=new I(n),e.specular=new I(i),e.shininess=2e3,console.log(e.specular),e.uniforms.diffuse.value=e.color,e.uniforms.specular.value=e.specular,e.uniforms.shininess.value=Math.max(e.shininess,1e-4),e.uniforms.opacity.value=e.opacity,e.defines.WIDTH=d.toFixed(1),e.defines.BOUNDS=c.toFixed(1),G=e.uniforms,p=new M(r,e),p.rotation.x=-Math.PI/2,p.matrixAutoUpdate=!1,p.updateMatrix(),h.add(p);const o=new U(c,c,1,1);w=new M(o,new te({color:16777215,visible:!1})),w.rotation.x=-Math.PI/2,w.matrixAutoUpdate=!1,w.updateMatrix(),h.add(w),l=new ne(d,d,u),fe()&&l.setDataType(oe);const t=l.createTexture();pe(t),s=l.addVariable("heightmap",document.getElementById("heightmapFragmentShader").textContent,t),l.setVariableDependencies(s,[s]),s.material.uniforms.mousePos={value:new b(1e4,1e4)},s.material.uniforms.mouseSize={value:11},s.material.uniforms.viscosityConstant={value:.94},s.material.uniforms.heightCompensation={value:0},s.material.defines.BOUNDS=c.toFixed(1);const a=l.init();a!==null&&console.error(a),l.createShaderMaterial(document.getElementById("smoothFragmentShader").textContent,{smoothTexture:{value:null}}),v=l.createShaderMaterial(document.getElementById("readWaterLevelFragmentShader").textContent,{point1:{value:new b},levelTexture:{value:null}}),v.defines.WIDTH=d.toFixed(1),v.defines.BOUNDS=c.toFixed(1),R=new Uint8Array(4*1*4),P=new re(4,1,{wrapS:A,wrapT:A,minFilter:B,magFilter:B,format:ae,type:ie,depthBuffer:!1})}function fe(){return!!navigator.userAgent.match(/Safari/i)&&!navigator.userAgent.match(/Chrome/i)}function pe(r){const e=10;function n(t,a){let x=e,y=.025,W=0;for(let C=0;C<15;C++)W+=x*de.noise(t*y,a*y),x*=.53+.025*C,y*=1.25;return W}const i=r.image.data;let o=0;for(let t=0;t<d;t++)for(let a=0;a<d;a++){const x=a*128/d,y=t*128/d;i[o+0]=n(x,y),i[o+1]=i[o+0],i[o+2]=0,i[o+3]=1,o+=4}}function he(){const r=new M(new se(4,24,12),new le({color:16776960}));for(let e=0;e<S;e++){let n=r;e<S-1&&(n=r.clone()),n.position.x=(Math.random()-.5)*c*.7,n.position.z=(Math.random()-.5)*c*.7,n.userData.velocity=new H,h.add(n),F[e]=n}}function ge(){const r=l.getCurrentRenderTarget(s);v.uniforms.levelTexture.value=r.texture;for(let e=0;e<S;e++){const n=F[e];if(n){const i=.5*n.position.x/m+.5,o=1-(.5*n.position.z/m+.5);v.uniforms.point1.value.set(i,o),l.doRenderTarget(v,P),u.readRenderTargetPixels(P,0,0,4,1,R);const t=new Float32Array(R.buffer);E.set(t[1],0,-t[2]);const a=n.position;a.y=t[0],E.multiplyScalar(.1),n.userData.velocity.add(E),n.userData.velocity.multiplyScalar(.998),a.add(n.userData.velocity),a.x<-m?(a.x=-m+.001,n.userData.velocity.x*=-.3):a.x>m&&(a.x=m-.001,n.userData.velocity.x*=-.3),a.z<-m?(a.z=-m+.001,n.userData.velocity.z*=-.3):a.z>m&&(a.z=m-.001,n.userData.velocity.z*=-.3)}}}function we(){f.aspect=window.innerWidth/window.innerHeight,f.updateProjectionMatrix(),u.setSize(window.innerWidth,window.innerHeight)}function ve(r,e){N.set(r/u.domElement.clientWidth*2-1,-(e/u.domElement.clientHeight)*2+1),T=!0}function ye(r){r.isPrimary!==!1&&ve(r.clientX,r.clientY)}function k(){requestAnimationFrame(k),xe(),D.update()}function xe(){const r=s.material.uniforms;if(T){O.setFromCamera(N,f);const e=O.intersectObject(w);if(e.length>0){const n=e[0].point;r.mousePos.value.set(n.x,n.z)}else r.mousePos.value.set(1e4,1e4);T=!1}else r.mousePos.value.set(1e4,1e4);l.compute(),z&&ge(),G.heightmap.value=l.getCurrentRenderTarget(s).texture,u.render(h,f)}function Se(r){var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(r);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null}
